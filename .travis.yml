# CI Environment
dist: bionic

# Job Configurations
jobs:
  include:
    - language: python
      python: "3.9.6"
      addons:
        sonarcloud:
          organization: swppfall2022-team15
          token:
            secure: "XtbRBijrA05EqsrMqst9XUOwEX6DDyxnzaMHAE1tg59rVpTAaJsDkFKXLXvnfKE+ACVEWYp2vH8RsWBPVOvdjHxwuu8pVrNJwIkQCWJHGh+jxhU0hRo1MtJiueAZH3uj2Om8bdS3SHGWiMwJzs03XB9SDjIFKo9Gh2uZxnhKfK4CzUjPqOyOTXa8zGInfK4esn/8yHoYOD5n8QMr2zP+Y5Sk2KZXGwN+pHlRk2DGb44PAx60BumjdVoRPpc6gwZiQnsnso2mMp0yNRmvoagVEeY8XYb/jYMIwsx+gTU1sPVLvsd5sQm9lUZMOcuyNU0wgWJUtaVLrHVWdUyJCGU9eH71ZVj14BlYA9lMHZ72MGpiwrA1N8F9dw8zH68IJpG2N5X4ECv/isv7qAiXCHEIhI9ARiG/esHj1nL0xYDIv9ucYXyZkcfi11WoZG9BpKmMbW7pxPwp2e9UzO879A6ZbhPAjMRbuzncEwhO39m5dmOyXPFdi3XORMAljgDsEOlAINI4ejwaUNRUj4lSDPzsKr/pCx7VqNFfWDkivJFiRpc5xMYWwnkn6BRQHXb2V/2JGxZInluMm9qDTe+Ca8tfkrV6gdhcfcpszQu7NKvQXELkynNsVuck/J0+y+6zsXVd/6JIqFDVhw/aN3deIjp1bcFIHTS9m5BsLi2Qhd2+6tM="
      install:
        - cd backend
        - pip install pipenv
        - pipenv install --dev --deploy --system
      script:
        - PYTHONPATH=${PWD} DJANGO_SETTINGS_MODULE=noti_manager.settings pylint **/*.py --load-plugins pylint_django
        - coverage run --source='.' manage.py test
        - coverage xml
        - cd .. && sonar-scanner
    - language: node_js
      node_js: 14
      install:
        - cd frontend
        - yarn install
      script:
        - ./node_modules/.bin/eslint src
        - yarn test --coverage --watchAll=false
